
@{
    ViewBag.Title = "Contact";
    Layout = "~/Areas/Admin/Views/Shared/AdminLayout.cshtml";
}


@model DTO.UserDTO
@section Styles {
    <link href="~/Areas/Admin/Content/CSS/adminlte.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="~/Content/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">


}
<section class="content-header">
    <h1>線上客服</h1>
    <ol class="breadcrumb float-sm-left">
        <li class="breadcrumb-item"><a>後臺頁面</a></li>
        <li class="breadcrumb-item active"><a>線上客服</a></li>
    </ol>
</section>
<br />
<div class="card-footer">
    <button type="submit" class="btn btn-primary" onclick="window.location.href='/Admin/Gift/AddGift'">目前登入會員</button>
</div>

<div class="col-md-9 m-auto">
    <!-- DIRECT CHAT WARNING -->
    <div class="card direct-chat">
        <div class="card-header " style="cursor: default; pointer-events: none; background-color: #007bff ">
            <h3 class="card-title mb-0" style="color:white;padding:5px">聯絡客服</h3>
        </div>
            <input type="hidden" id="displayname" />

            <div class="card-body" style="padding:5px">
                <!-- Conversations are loaded here -->
                <div class="direct-chat-messages" id="chatbox" style="margin: 10px; padding:0px">

                </div>
                <div class="direct-chat-msg right" id="adminbox" style="margin: 10px">
                    
                </div>
            </div>

        <div class="card-footer">
                <div class="input-group">
                    <div class="col-12 col-md-9 col-lg-10 mb-2">
                        <input type="text" name="message" placeholder="輸入訊息..." class="form-control" id="message" autocomplete="off" >
                    </div>
                    <div class="col-12 col-md-3 col-lg-2">
                        <span class="input-group-append">
                            <input type="button" class="btn btn-primary" id="sendmessage" value="傳送" style="width:100%" />

                        </span>
                    </div>

                </div>
        </div>
    </div>
</div>
<!--<div class="col-md-12 m-auto">-->
<!-- DIRECT CHAT WARNING -->
<!--<div class="card direct-chat direct-chat-warning">
    <div class="card-header button primary" style="cursor:default; pointer-events:none">
        <h3 class="card-title" style="color:white">聯絡客服</h3>
    </div>-->
<!-- /.card-header -->
<!--<div class="card-body">-->
<!-- Conversations are loaded here -->
<!--<div class="direct-chat-messages" id="chatbox">

</div>-->
<!-- /.direct-chat-pane -->
<!--</div>-->
<!-- /.card-body -->
<!--<div class="card-footer">
    <form class="mb-0">
        <div class="input-group">
            <div class="col-12 col-md-10  mb-2">
                <input type="text" name="message" placeholder="輸入訊息..." class="form-control" id="message">
            </div>
            <div class="col-12 col-md-2">
                <span class="input-group-append">
                    <button class="button primary fit" id="sendmessage">傳送</button>
                </span>
            </div>

        </div>
    </form>
</div>-->
<!-- /.card-footer-->
<!--</div>-->
<!--/.direct-chat -->
<!--</div>-->
@section scripts {
    <!--Script references. -->
    <script src="~/Areas/Admin/Content/JS/angular.min.js"></script>

    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <script src="~/Scripts/jquery-1.6.4.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.4.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/Areas/Admin/Content/JS/signalr-hub.js"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script src="~/signalr/hubs"></script>

    <script>
                $(function () {
                    // Reference the auto-generated proxy for the hub.
                    var chat = $.connection.chatHub;
                    // Create a function that the hub can call back to display messages.
                    chat.client.addNewMessageToPage = function (name, imagePath, message) {
                        // Add the message to the page.
                        $('#chatbox').append('\
                            <div class= "direct-chat-infos clearfix">\
                            <span class="direct-chat-name float-left">' + name
                            + '</span>'
                            + '<span class="direct-chat-timestamp float-right">'
                            + Date($.now()).substring(4, 24)
                            + '</span>'
                            + '</div>'
                            + '<img class="direct-chat-img" src="/Areas/Admin/Content/UserImage/' + imagePath
                            + '">'
                            + '<div class="direct-chat-text mb-1">' + message
                            + '</div>'
                            );
                    };

                    // Get the user name and store it to prepend to messages.
                    //$('#displayname').val(prompt('Enter your name:', ''));
                    // Set initial focus to message input box.
                    $('#message').focus();
                    // Start the connection.
                    $.connection.hub.start().done(function () {
                        $('#sendmessage').click(function () {
                            if ($('#message').val().trim().length != 0) {
                                // Call the Send method on the hub.
                            chat.server.send(`@
                            ["Name"]`, `@Session["ImagePath"]`, $('#message').val());
                            // Clear text box and reset focus for next comment.
                            $('#message').val('').focus();

                            }

                        });
                    });
                });

    </script>
}

